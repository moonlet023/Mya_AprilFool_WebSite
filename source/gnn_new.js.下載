var pcUrlPattern=/https?:\/\/gnn\.gamer\.com\.tw\/detail\.php\?sn=(\d+)/i,snA=window.location.href.match(pcUrlPattern);getCookie("ckNOMOBILE")!="1"&&snA!==null&&(mobileUrl="https://m.gamer.com.tw/gnn/detail.php?sn="+snA[1],window.Util.UserAgent.isMobile()&&window.location.replace(mobileUrl));let isLike=!1;var gnn={news:function(t,a){var e=parseInt(jQuery("#sltYear").val()),n=parseInt(jQuery("#sltMonth").val());if(e===0||n===0)return Dialogify.alert("\u8ACB\u9078\u64C7\u65E5\u671F\uFF5E"),!1;var o="?yy="+e+"&mm="+n;t&&(o+="&k="+t),a&&(o+="&m="+a),location.href=o},moreNews:function(t,a){var e=new Date().getFullYear();jQuery("#sltYear").val(e);var n=new Date().getMonth()+1;jQuery("#sltMonth").val(n),gnn.news(t,a)},acgNews:function(t,a){var e=parseInt(jQuery("#sltYear").val()),n=parseInt(jQuery("#sltMonth").val());if(e===0||n===0)return Dialogify.alert("\u8ACB\u9078\u64C7\u65E5\u671F\uFF5E"),!1;var o="?yy="+e+"&mm="+n;t&&(o+="&p="+t),a&&(o+="&k="+a),location.href="news.php"+o},acgMoreNews:function(t,a){var e=new Date().getFullYear();jQuery("#sltYear").val(e);var n=new Date().getMonth()+1;jQuery("#sltMonth").val(n),gnn.acgNews(t,a)},commentFormatter:function(t){t=jQuery(t),t.each(function(a){var e=jQuery(this);if(e.data("formatted")!="yes"){var n=e.html();n=n.replace(/https?:\/\/[!#-&(-;=?-Z\^-~]+/gi,function(o){var l=/^https?:\/\/www\.youtube\.com\/watch\?v=([0-9a-zA-Z_-]{11})(?:&(t=[hms0-9]+))?/,c=/^https?:\/\/youtu\.be\/([0-9a-zA-Z_-]{11})(?:\?(t=[hms0-9]+))?/,i=/^https?:\/\/www\.facebook\.com\/(\w+)\/videos\/(\d+)\//,s,r;return r='<a target="_blank" onclick="Util.ChangeText.refurl(this);" href="'+o+'">'+o+"</a>",r}),e.attr("data-formatted","yes").html(n)}})},bindTippy:function(){let t=tippy(".shareandmore .morebtn",{html:"#optionMenu",position:"top",arrow:!0,interactive:!0,hideOnClick:!1,theme:"light",distance:5,duration:240})},like:function(t,a){BahaWallGp.like(a,function(e){var l,c;jQuery(".shareandmore .likebtn-img").toggleClass("is-active"),jQuery(".shareandmore .backpic").toggleClass("is-click");let n=jQuery(".shareandmore .baha_btn-biglike p span"),o=n.text();if(e){if(n.text(parseInt(o)+1),(l=document.querySelector(".article_gamercard"))!=null&&l.dataset.fanspageId){let i="";for(let r=0;r<4;r++)i+=String(Math.floor(Math.random()*10));Cookies.set("ckAPP_VCODE",i,{domain:"gamer.com.tw",path:"/"});let s=new FormData;s.append("vcode",i),s.append("fid",document.querySelector(".article_gamercard").dataset.fanspageId),fetch("https://api.gamer.com.tw/ajax/wall/fanspage_follow.php?from=web_gnn",{method:"post",body:s,credentials:"include"}).then(r=>r.json()).then(r=>{if(r.error){Dialogify.alert(r.error.message);return}jQuery(".article_gamercard .gamecard__follow").addClass("is-active").text("\u5DF2\u8FFD\u8E64")}).catch(r=>{Dialogify.alert(r)})}}else if(n.text(parseInt(o)-1),(c=document.querySelector(".article_gamercard"))!=null&&c.dataset.fanspageId){let i=new Bahamut.Csrf;i.setCookie();let s=new FormData;s.append("fansId",document.querySelector(".article_gamercard").dataset.fanspageId),s.append("type",2),s.append("class",2),fetch("https://wall.gamer.com.tw/app/v1/fans_join.php",{method:"post",body:s,headers:i.getFetchHeaders(),credentials:"include"}).then(r=>r.json()).then(r=>{if(r.error){Dialogify.alert(r.error.message);return}jQuery(".article_gamercard .gamecard__follow").removeClass("is-active").text("\u8FFD\u8E64")}).catch(r=>{Dialogify.alert(r)})}})},getLike:function(t){BahaWallGp.getLikeCountAndStatus(t,function(a){jQuery(".shareandmore .baha_btn-biglike").show(),a.isLike&&(jQuery(".shareandmore .likebtn-img").addClass("is-active"),jQuery(".shareandmore .backpic").addClass("is-click")),jQuery(".shareandmore .baha_btn-biglike p span").text(a.like)})}};jQuery(()=>{const t=document.querySelector("a.sharebtn-container_collapse-share");if(t){const a=jQuery(t).next("ul");t.addEventListener("mouseenter",e=>{a.addClass("is-show")}),document.querySelector(".shareandmore").addEventListener("mouseout",e=>{const n=jQuery(e.relatedTarget);!n.is(".shareandmore")&&n.parents(".shareandmore").length==0&&a.removeClass("is-show")})}jQuery("[name=gnnPIC]:not(.slick-cloned [name=gnnPIC])").on("click","",function(a){let e=[];jQuery("[name=gnnPIC]:not(.slick-cloned [name=gnnPIC])").each(function(){let n="";jQuery(this).attr("data-src")!=null?n=jQuery(this).attr("data-src"):n=jQuery(this).attr("src");let o=/https?:\/\/((?:pic|p2)\.bahamut\.com\.tw)\/[BMS]\/2KU\/([0-9]{2})\/([a-zA-Z0-9]{10,}\.(:?JPE?G|GIF|PNG|BMP|WEBP))(?:\?.+?)?/;(matches=n.match(o))&&(n="https://"+matches[1]+"/B/2KU/"+matches[2]+"/"+matches[3]),e.push({src:n,w:0,h:0})}),photoSwipeShow(e,a.target)})});function get_all_comment(t){$.ajax({url:"/ajax/gnn_list_comment.php",loading:function(){document.getElementById("comment").innerHTML='<img src="https://i2.bahamut.com.tw/loading.gif">'},success:function(a){document.getElementById("comment").innerHTML=a,gnn.commentFormatter(jQuery(".comment-text"))},param:"sn="+t,method:"GET"})}function comment_ck(t){if(document.getElementById("comment_btn").disabled){Dialogify.alert("\u8655\u7406\u4E2D\uFF0C\u8ACB\u7A0D\u5019!");return}if($("#comment_input").val()==""){Dialogify.alert("\u8ACB\u8F38\u5165\u8A55\u8AD6!");return}if(Util.String.utf8Length($("#comment_input").val())>150){Dialogify.alert("\u9650 50 \u500B\u4E2D\u6587\u5B57\u5594!");return}document.getElementById("comment_btn").disabled=!0;var a='\u2605 \u6BC0\u8B17\u5C6C\u5211\u4E8B\u6848\u4EF6 (\u6703\u7559\u4E0B\u524D\u79D1)\uFF0C\u656C\u544A\u767C\u8868\u8005\u81EA\u8CA0\u6CD5\u5F8B\u8CAC\u4EFB\u3002 <a href="https://user.gamer.com.tw/help/detail.php?sn=274" target="_blank">\u2192\u4E86\u89E3\u66F4\u591A</a><br>\u2605 \u826F\u6027\u6279\u8A55\u53EF\u3002\u7121\u95DC\u6216\u542B\u6709\u60E1\u610F\u6279\u8A55\u6587\u5B57\u3001\u5F71\u5C04\u3001\u6B67\u8996\u3001\u8AE7\u97F3\u7B49\u7559\u8A00\u5C07\u6703\u522A\u9664\u3002<br>\u2605 \u5DF4\u54C8\u59C6\u7279\u5168\u6B0A\u6C7A\u5B9A\u522A\u9664\u6A19\u6E96\uFF0C\u7D2F\u72AF\u8005\u5C07\u6C38\u4E45\u53D6\u6D88\u65B0\u805E\u7559\u8A00\u8CC7\u683C\uFF0C\u4E26\u8996\u60C5\u6CC1\u5168\u7AD9\u7981\u8CBC\u8655\u5206\u3002',e={"\u6211\u4E86\u89E3\uFF0C\u9001\u51FA\u8A55\u8A9E":function(){$.ajax({url:"/ajax/gnn_comment.php",success:function(n){if($.lightbox.close(),n.substr(0,3)=="1__"){$.bahabox(n.substr(3),"\u932F\u8AA4\u8A0A\u606F");return}document.getElementById("reply_comment").innerHTML+=n,document.getElementById("comment_input").value="",document.getElementById("comment_btn").disabled=!1,gnn.commentFormatter(jQuery(".comment-text"))},param:"sn="+t+"&cont="+encodeURIComponent($("#comment_input").val()),method:"POST"})},\u53D6\u6D88:function(){document.getElementById("comment_btn").disabled=!1,$.lightbox.close()}};$.bahabox(a,"\u767C\u8868\u524D\uFF0C\u8ACB\u5148\u78BA\u8A8D\uFF1A",e,{closeButton:!1})}function enterKey(t,a){var e=isIE()?t.keyCode:t.which;e==13&&(t.preventDefault?t.preventDefault():t.returnValue=!1,comment_ck(a))}function mind(t){var a=$("[name=rb]").filter("[checked]").val();if(a!=null){$.ajax({url:"/ajax/gnn_mind.php",success:showmind,param:"sn="+t+"&mind="+a,method:"POST"});var e=$.cookie.get("ckGNNmind");if(e=="")var n=",";n+=e+t+",",$.cookie.set("ckGNNmind",n)}else alert("\u8ACB\u9078\u64C7\u4E00\u500B\u8868\u60C5\u7B26\u865F")}function showmind(t){var a=t.getElementsByTagName("error");if(a.length){alert(a[0].firstChild.nodeValue);return}for(var e=t.getElementsByTagName("mind"),n="",o=$("[name=rb]").filter("[checked]").val(),l=1,c=0,i=0;i<e.length;i++)parseInt(e[i].firstChild.nodeValue)>l&&(l=parseInt(e[i].firstChild.nodeValue)),c+=parseInt(e[i].firstChild.nodeValue);for(var i=0;i<e.length;i++){if(parseInt(e[i].firstChild.nodeValue)>0)var s=Math.round(parseInt(e[i].firstChild.nodeValue)/parseInt(c)*100),r=50*parseInt(e[i].firstChild.nodeValue)/l,m=50-r;else var s=0,m=50,r=0;if(i==o-1)var u="red";else var u="blue";n+="<p>",m!=0&&(n+='<img src="https://i2.bahamut.com.tw/gnn/dark.jpg" width="15" height="'+m+'" alt="'+s+'%">'),r!=0&&(n+='<img src="https://i2.bahamut.com.tw/gnn/'+u+'.gif" width="15" height="'+r+'" alt="'+s+'%">'),n+='<img src="https://i2.bahamut.com.tw/gnn/face_0'+(i+1)+'.gif" /></p>'}$("#mind").html(n)}function del_multi(){var t=document.getElementById("frmdel");t.submit()}function delcomment_S(t){jQuery("[data-uid="+t+"]").prop("checked",!0),jQuery("#frmdel").submit()}function close_comment(){var t=jQuery(".GN-lbox6A").length;$(".GN-lbox6A:lt("+(t-5)+")").hide(),$("#comment_switch_up").html('<img src="https://i2.bahamut.com.tw/gnn/bit.gif" class="IMG-E25"><a href="javascript:open_comment()">\u986F\u793A\u6240\u6709\u7684 '+t+" \u5247\u8A55\u8A9E</a>"),$("#comment_switch_down").html("")}function open_comment(){var t=jQuery(".GN-lbox6A").length;jQuery(".GN-lbox6A:lt("+(t-5)+")").show(),jQuery("#comment_switch_up").html('<img src="https://i2.bahamut.com.tw/gnn/bit.gif" class="IMG-E44"><a href="javascript:close_comment()">\u95DC\u9589\u6240\u6709\u8A55\u8A9E</a>'),jQuery("#comment_switch_down").html('<img src="https://i2.bahamut.com.tw/gnn/bit.gif" class="IMG-E44"><a href="javascript:close_comment()">\u95DC\u9589\u6240\u6709\u8A55\u8A9E</a>')}function accuse_comment(t,a){if(!User.Login.requireLogin())return!1;var e="";e+='<p style="font-size: 15px;">\u9019\u5247\u7559\u8A00\u662F\uFF1A</p>',e+=`<select id="areason" class="text-field" onChange="if (this.value != 7) {jQuery('#aExp').hide();} else {jQuery('#aExp').show();}">`,e+='<option value="0">-\u8ACB\u9078\u64C7\u7406\u7531-</option>',e+='<option value="1">\u60E1\u610F\u6279\u8A55</option>',e+='<option value="2">\u6311\u7B46\u6230</option>',e+='<option value="3">\u4E0D\u76F8\u95DC</option>',e+='<option value="4">\u9055\u53CD\u7AD9\u898F</option>',e+='<option value="5">\u4E0D\u96C5\u8A00\u8A5E</option>',e+='<option value="6">\u7279\u5B9A\u7A2E\u65CF\u6B67\u8996</option>',e+='<option value="7">\u5176\u4ED6\u7406\u7531</option>',e+="</select>",e+='<input id="aExp" type="text" class="text-field" placeholder="\uFF08\u8ACB\u8F38\u5165 50 \u5B57\u5167\u4E4B\u8AAA\u660E\uFF09" maxlength="50" style="display: none;">',e+='<p style="color: #999999; font-size: 12px;">\u4EBA\u8EAB\u653B\u64CA\u3001\u4FB5\u72AF\u500B\u4EBA\u96B1\u79C1\u3001\u8457\u4F5C\u6B0A\u9650\u7576\u4E8B\u4EBA\u6AA2\u8209\u3002</p>',e+='<p style="color: #999999; font-size: 12px;">\u60E1\u610F\u6AA2\u8209\uFF0C\u7D93\u67E5\u8B49\u5C6C\u5BE6\u5C07\u4F9D\u7AD9\u898F\u8655\u5206\u3002</p>',new Dialogify(e,{useDialogForm:!1}).title("\u6AA2\u8209\u7559\u8A00").buttons([{text:"\u53D6\u6D88",click:function(){this.close()}},{text:"\u78BA\u5B9A",type:Dialogify.BUTTON_PRIMARY,click:function(){accuseComment(t,a,this)}}]).showModal()}function accuseComment(t,a,e){var n=parseInt(e.$content.find("#areason").val()),o="";if(n===7?o=e.$content.find("#aExp").val():o=e.$content.find("#areason :selected").text(),n===0||o.length===0)return Dialogify.alert("\u8ACB\u63D0\u4F9B\u6AA2\u8209\u7406\u7531"),!1;if(Util.String.utf8Length(o)>150)return Dialogify.alert("\u5B57\u6578\u8D85\u904E 50"),!1;Dialogify.confirm("\u78BA\u5B9A\u9001\u51FA\u6AA2\u8209\uFF1F",{ok:function(){getCSRFToken(t).done(function(l){jQuery.ajax({url:"/ajax/comment_accuse.php",method:"POST",data:{sn:t,g:n,ar:o,token:l,userId:a}}).done(function(c){e.close(),Dialogify.alert(c)})})}})}function baha_bookmark(t,a,e){t===void 0&&(t=""),a===void 0&&(a=document.title),e===void 0&&(e=location.href);var n=location.href.match(/\?sn=(\d+)/);if(n===null||n[1]===null)return Dialogify.alert("\u6536\u85CF\u5931\u6557"),!1;var o="";jQuery('meta[property="og:image"]').attr("content")&&(o=jQuery('meta[property="og:image"]').attr("content"));let l=new Bahamut.Csrf;l.setCookie(),jQuery.ajax({url:"https://api.gamer.com.tw/home/v1/bookmark_new.php",method:"GET",data:{title:a,url:e,nopic:o+t},cache:!1,xhrFields:{withCredentials:!0},headers:l.getJqueryHeaders()}).done(function(c){c.hasOwnProperty("error")?alert(c.error.message):Dialogify.alert('\u6536\u85CF\u5B8C\u6210\uFF01\u5DF2\u6536\u81F3<a href="https://home.gamer.com.tw/bookmark.php?owner='+User.Login.getUserid()+'">\u300C\u6211\u7684\u6536\u85CF\u300D</a>\u3002')})}function getCSRFToken(t){return jQuery.ajax({url:"/ajax/getCSRFToken.php",method:"POST",data:{s:t},cache:!1})}function getCookie(t){var a="";return jQuery.cookie!==void 0?a=jQuery.cookie(t):a=egg.cookie.get(t),a}function resizeImage(t){jQuery(".gnn-detail-cont div > img[name=gnnPIC], .gnn-detail-cont div > a > img[name=gnnPIC]").load(function(){let a=Math.min(Math.round(window.devicePixelRatio),2),e=jQuery(this);e.attr("srcset").split(",")[1]!=null&&/[^-]width:/.test(e.attr("style"))==!1&&/^width:/.test(e.attr("style"))==!1&&e.attr("width")==null&&(e.width()&&e.width()*a>t||e.parents("table").length!=0&&e.width()*a>=e.parents("td").width()?e.width("100%"):e.width(e.width()*a+"px"))})}function photoSwipeShow(t,a){if(!a.src)return;let e=[],n=0,o=new URL(a.src);o=o.origin+o.pathname;let l=/https?:\/\/((?:pic|p2)\.bahamut\.com\.tw)\/[BMS]\/2KU\/([0-9]{2})\/([a-zA-Z0-9]{10,}\.(:?JPE?G|GIF|PNG|BMP|WEBP))(?:\?.+?)?/;(matches=o.match(l))&&(o="https://"+matches[1]+"/B/2KU/"+matches[2]+"/"+matches[3]),t.forEach((s,r)=>{let m;if(!s.src.match(/^https?:\/\/.+/))m=s.src;else{let u=new URL(s.src);m=u.origin+u.pathname,m===o&&(n=r)}e.push({src:m,w:s.w,h:s.h})});let c={index:n,bgOpacity:.85,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">\u5716\u7247</a>\u7121\u6CD5\u8F09\u5165</div>',history:!1,shareEl:!1},i=new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,e,c);i.listen("gettingData",function(s,r){if(r.onloading===void 0&&(r.w<1||r.h<1)&&r.html===void 0){r.onLoading=!0;let m=new Image;m.onload=function(){r.w=this.width,r.h=this.height,i.invalidateCurrItems(),i.updateSize(!0)},m.src=r.src}}),i.init()}
